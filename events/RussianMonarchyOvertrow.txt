###########################
# Russian Revolution Events
###########################

add_namespace = russian_ovrthrw_of_mon

# Арест Рабочей группы ЦВПК
country_event = {
	id = russian_ovrthrw_of_mon.1
	title = russian_ovrthrw_of_mon.1.t
	desc = russian_ovrthrw_of_mon.1.desc
	picture = GFX_report_event_rus_arest_cmic
	
	trigger = {
		tag = RUS
		OR = {
			has_government = authoritarism
			has_government = despotism
		}
		has_country_flag = RUS_monarchy_not_fall
		OR = {
			has_war_with = GER
			has_war_with = AUH
			has_war_with = FRA
			has_war_with = ENG
		}
	}
	
	mean_time_to_happen = {
		days = 38
		modifier = {
			factor = 0.01
			date > 1917.2.1
		}
	}
	
	fire_only_once = yes
	
	option = {
		name = russian_ovrthrw_of_mon.1.a
		add_popularity = { ideology = social_democracy popularity = -0.04 }
		add_popularity = { ideology = social_liberalism popularity = -0.02 }
		add_political_power = 50
		ai_chance = {
			factor = 1
		}
	}
	
	option = {
		name = russian_ovrthrw_of_mon.1.b
		add_stability = 0.04
		ai_chance = {
			factor = 0
		}
	}
}

# Забастовка на Путиловском заводе
country_event = {
	id = russian_ovrthrw_of_mon.2
	title = russian_ovrthrw_of_mon.2.t
	desc = russian_ovrthrw_of_mon.2.desc
	picture = GFX_report_event_rus_putilovs_fabric
	
	trigger = {
		tag = RUS
		OR = {
			has_government = authoritarism
			has_government = despotism
		}
		has_country_flag = RUS_monarchy_not_fall
		OR = {
			has_war_with = GER
			has_war_with = AUH
			has_war_with = FRA
			has_war_with = ENG
		}
		date > 1917.2.1
	}
	
	mean_time_to_happen = {
		days = 20
		modifier = {
			factor = 0.2
			RUS = {
				controls_state = 195
				NOT = { has_full_control_of_state = 195 }
			}
		}
	}
	
	fire_only_once = yes
	
	option = {
		name = russian_ovrthrw_of_mon.2.a
		add_popularity = { ideology = authoritarism popularity = -0.01 }
		add_timed_idea = { idea = RUS_mass_workers_strikes days = 20 }
		hidden_effect = { country_event = { id = russian_ovrthrw_of_mon.3 days = 4 } }
	}
}

# Хлебные бунты
country_event = {
	id = russian_ovrthrw_of_mon.3
	title = russian_ovrthrw_of_mon.3.t
	desc = russian_ovrthrw_of_mon.3.desc
	picture = GFX_report_event_rus_bread
	
	trigger = {
		tag = RUS
		OR = {
			has_government = authoritarism
			has_government = despotism
		}
		has_country_flag = RUS_monarchy_not_fall
		OR = {
			has_war_with = GER
			has_war_with = AUH
			has_war_with = FRA
			has_war_with = ENG
		}
		has_political_power < 0
		date > 1917.2.1
	}
	
	is_triggered_only = yes
	
	option = {
		name = russian_ovrthrw_of_mon.3.a
		add_stability = -0.01
		add_political_power = -50
		set_country_flag = RUS_petrograd_miting
		add_popularity = { ideology = authoritarism popularity = -0.05 }
		add_popularity = { ideology = despotism popularity = -0.05 }
		country_event = { id = russian_ovrthrw_of_mon.5 hours = 16 }
		if = {
			limit = { NOT = { has_stability > 0.05 } }
			hidden_effect = { country_event = { id = russian_ovrthrw_of_mon.4 days = 3 } }
		}
	}
}

# Демонстрации в Петрограде
country_event = {
	id = russian_ovrthrw_of_mon.4
	title = russian_ovrthrw_of_mon.4.t
	desc = russian_ovrthrw_of_mon.4.desc
	picture = GFX_report_event_rus_bund_bleat
	
	trigger = {
		tag = RUS
		OR = {
			has_government = authoritarism
			has_government = despotism
		}
		has_country_flag = RUS_monarchy_not_fall
		has_country_flag = RUS_petrograd_miting
		NOT = { has_country_flag = RUS_petrograd_miting_2 }
		OR = {
			has_war_with = GER
			has_war_with = AUH
			has_war_with = FRA
			has_war_with = ENG
		}
		has_political_power < 0
		NOT = { controls_state = 64 }
	}
	
	mean_time_to_happen = {
		days = 3
		modifier = {
			factor = 10
			has_stability > 0.05
		}
	}
	
	fire_only_once = yes
	
	option = {
		name = russian_ovrthrw_of_mon.4.a
		add_political_power = -50
		add_stability = -0.05
		set_country_flag = RUS_petrograd_miting_2
		add_popularity = { ideology = authoritarism popularity = -0.05 }
		add_popularity = { ideology = despotism popularity = -0.05 }
		hidden_effect = { country_event = { id = russian_ovrthrw_of_mon.8 days = 5 } }
	}
}

# Отъезд царя в ставку
country_event = {
	id = russian_ovrthrw_of_mon.5
	title = russian_ovrthrw_of_mon.5.t
	desc = russian_ovrthrw_of_mon.5.desc
	picture = GFX_report_event_rus_tsar_in_the_train
	
	is_triggered_only = yes
	
	option = {
		name = russian_ovrthrw_of_mon.5.a
		add_stability = -0.01
		add_command_power = 200
		add_war_support = 0.03
	}
}

# Роспуск Думы
country_event = {
	id = russian_ovrthrw_of_mon.6
	title = russian_ovrthrw_of_mon.6.t
	desc = russian_ovrthrw_of_mon.6.desc
	picture = GFX_report_event_rus_fevral
	
	is_triggered_only = yes
	
	#Не распускать
	option = {
		name = russian_ovrthrw_of_mon.6.a
		add_stability = 0.05
		add_popularity = { ideology = market_liberalism popularity = 0.05 }
		set_country_flag = RUS_make_concessions_with_duma
	}
	#Распустить
	option = {
		name = russian_ovrthrw_of_mon.6.b
		add_political_power = 25
		set_country_flag = RUS_duma_dissolved
	}
}

# Роспуск части армии
country_event = {
	id = russian_ovrthrw_of_mon.7
	title = russian_ovrthrw_of_mon.7.t
	desc = russian_ovrthrw_of_mon.7.desc
	picture = GFX_report_event_rus_fevral
	
	is_triggered_only = yes
	
	#Части выказавшие открытое неповиновение должны быть распущены
	option = {
		name = russian_ovrthrw_of_mon.7.a
		add_stability = 0.05
		add_war_support = 0.05
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1899 goda"
		}
	}
	#Даже части замеченые в братании будут распущены
	option = {
		name = russian_ovrthrw_of_mon.7.b
		add_stability = 0.05
		add_war_support = 0.1
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1899 goda"
		}
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1900 goda"
		}
		if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_5 }
			remove_ideas = soldiers_fraternity_GER_RUS_5
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_5 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_4 }
			remove_ideas = soldiers_fraternity_GER_RUS_4
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_4 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_3 }
			remove_ideas = soldiers_fraternity_GER_RUS_3
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_3 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_2 }
			remove_ideas = soldiers_fraternity_GER_RUS_2
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_2 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_1 }
			remove_ideas = soldiers_fraternity_GER_RUS_1
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_1 }
		}
	}
	#Мы переходим к плану полной демобилизации
	option = {
		trigger = { NOT = { has_war_with = GER } }
		name = russian_ovrthrw_of_mon.7.c
		add_stability = 0.1
		add_war_support = 0.1
		add_popularity = { ideology = authoritarism popularity = 0.05 }
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1899 goda"
		}
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1900 goda"
		}
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1901 goda"
		}
		delete_unit_template_and_units = {
			division_template = "Pekhotnaya Diviziya priziva 1902 goda"
		}
		country_event = { id = rcw.121 days = 4 }
		country_event = { id = rcw.122 days = 8 }
		country_event = { id = rcw.123 days = 15 }
		country_event = { id = rcw.124 days = 29 }
		country_event = { id = rcw.125 days = 48 }
		set_country_flag = RUS_not_bolsheviks_demobilisation
		if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_5 }
			remove_ideas = soldiers_fraternity_GER_RUS_5
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_5 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_4 }
			remove_ideas = soldiers_fraternity_GER_RUS_4
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_4 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_3 }
			remove_ideas = soldiers_fraternity_GER_RUS_3
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_3 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_2 }
			remove_ideas = soldiers_fraternity_GER_RUS_2
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_2 }
		}
		else_if = {
			limit = { has_idea = soldiers_fraternity_GER_RUS_1 }
			remove_ideas = soldiers_fraternity_GER_RUS_1
			GER = { remove_ideas = soldiers_fraternity_GER_RUS_1 }
		}
	}
}

# Вооружённое восстание
country_event = {
	id = russian_ovrthrw_of_mon.8
	title = russian_ovrthrw_of_mon.8.t
	desc = russian_ovrthrw_of_mon.8.desc
	picture = GFX_report_event_rus_krodshtat_refuse
	
	trigger = {
		tag = RUS
		has_country_flag = RUS_monarchy_not_fall
		has_country_flag = RUS_petrograd_miting_2
	}
	
	is_triggered_only = yes
	
	option = {
		name = russian_ovrthrw_of_mon.8.a
		set_country_flag = RUS_petrograd_soviet
		add_stability = -0.02
		add_popularity = {
			ideology = social_liberalism
			popularity = 0.05
		}
		add_popularity = {
			ideology = social_democracy
			popularity = 0.05
		}
		add_popularity = {
			ideology = radical_socialism
			popularity = 0.025
		}
		add_political_power = -50
		remove_ideas = {
			Alexander_Protopopov_4
		}
	}
}

# Приказ № 1
country_event = {
	id = russian_ovrthrw_of_mon.9
	title = russian_ovrthrw_of_mon.9.t
	desc = russian_ovrthrw_of_mon.9.desc
	picture = GFX_report_event_report_event_order_n_1
	
	trigger = {
		tag = RUS
		has_country_flag = RUS_petrograd_soviet
		NOT = { has_country_flag = RUS_revolution_suppressed }
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 2
	}
	
	option = {
		name = russian_ovrthrw_of_mon.9.a
		remove_ideas = RUS_Order_N_1_2
		remove_ideas = RUS_Order_N_1_3
		remove_ideas = RUS_Order_N_1_4
		if = {
			limit = { has_idea = RUS_army_decomposition }
			swap_ideas = {
				remove_idea = RUS_army_decomposition
				add_idea = RUS_Order_N_1_1
			}
			else = {
				add_ideas = RUS_Order_N_1_1
			}
		}
		swap_ideas = {
			remove_idea = limited_conscription
			add_idea = extensive_conscription
		}
		set_country_flag = RUS_Order_N_1
		add_popularity = {
			ideology = social_liberalism
			popularity = 0.025
		}
		add_popularity = {
			ideology = social_democracy
			popularity = 0.025
		}
		add_political_power = -50
	}
}

# Февральская революция
country_event = {
	id = russian_ovrthrw_of_mon.10
	title = russian_ovrthrw_of_mon.10.t
	desc = russian_ovrthrw_of_mon.10.desc
	picture = GFX_report_event_rus_fevral
	
	trigger = {
		tag = RUS
		has_country_flag = RUS_monarchy_not_fall
		OR = {
			has_government = authoritarism
			has_government = despotism
		}
		has_country_flag = RUS_petrograd_miting
		has_country_flag = RUS_petrograd_miting_2
		has_country_flag = RUS_petrograd_soviet
		NOT = { has_country_flag = RUS_revolution_suppressed }
		OR = {
			has_war_with = GER
			has_war_with = AUH
			has_war_with = FRA
			has_war_with = ENG
		}
		#has_stability < 0.05
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = russian_ovrthrw_of_mon.10.a
		add_popularity = { ideology = authoritarism popularity = -0.15 }
		add_popularity = { ideology = fascism popularity = -0.05 }
		add_popularity = { ideology = market_liberalism popularity = 0.05 }
		add_stability = 0.05
		add_political_power = 150
		remove_tsar_regime_unit_leaders = yes
		monarchy_fall = yes
		news_event = { id = news_n.5 hours = 36 }
		hidden_effect = {
			end_puppet = KHI
			end_puppet = BUK
			KHI = { leave_faction = yes }
			BUK = { leave_faction = yes }
			if = {
				limit = { KHI = { has_war = yes } }
				every_country = {
					limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH AND = { is_in_faction_with = TUR NOT = { is_in_faction_with = ENG } } AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } is_faction_leader = yes }
					white_peace = KHI
				}
			}
			if = {
				limit = { BUK = { has_war = yes } }
				every_country = {
					limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH AND = { is_in_faction_with = TUR NOT = { is_in_faction_with = ENG } } AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } is_faction_leader = yes }
					white_peace = BUK
				}
			}
		}
		
		hidden_effect = { lack_of_officers_rise = yes }
		set_country_flag = railway_self_government
		set_country_flag = RUS_provisional_government_created
		load_focus_tree = Russia_Provisional_government_focus
		create_country_leader = {
			name = "Georgiy Lvov"
			desc = "RUS_Georgiy_lvov_DESC"
			picture = "gfx/leaders/RUS/Georgiy_Lvov.dds"
			expire = "1935.1.1"
			ideology = market_liberalism_ideology
			traits = {
				stout_defender appeaser weak_character
			}
		}
		set_politics = {
			ruling_party = market_liberalism
			elections_allowed = no
		}
		add_ideas = RUS_dvoevlastie_1
		remove_ideas_with_trait = head_of_government
		remove_ideas_with_trait = foreign_minister
		remove_ideas_with_trait = economy_minister
		remove_ideas_with_trait = security_minister
		remove_ideas_with_trait = head_of_intel
		add_ideas = {
			Georgiy_Lviv_1
			Pavel_Milyukov_2
			Alexander_Konovalov_3
			Georgiy_Lviv_4
			Alexander_Kerensky_5
			Alexander_Guchkov_6
			Mikhail_Alekseyev_army_chief
		}
	}
}


# Диктатура военного времени
country_event = {
	id = russian_ovrthrw_of_mon.11
	title = russian_ovrthrw_of_mon.11.t
	desc = russian_ovrthrw_of_mon.11.desc
	picture = GFX_report_event_rus_krodshtat_refuse
	
	is_triggered_only = yes
	
	option = {
		name = russian_ovrthrw_of_mon.11.a
		create_country_leader = {
			name = "Nikolay Iudovich Ivanov"
			desc = RUS_Nikolay_Iudovich_Ivanov_DESC
			picture = "gfx/leaders/RUS/Nikolay_Ivanov.dds"
			ideology = despotism_ideology
			traits = {  }
		}
		set_politics = {
			ruling_party = despotism
			elections_allowed = no
		}
		add_ideas = RUS_Nikolay_II_idea
		add_ideas = RUS_Ivanov_dictatorship_idea
	}
	option = {
		name = russian_ovrthrw_of_mon.11.b
		create_country_leader = {
			name = "Mikhail Alexeev"
			desc = RUS_Mikhail_Alexeev_DESC
			picture = "gfx/leaders/RUS/Michael_Alexeev.dds"
			ideology = despotism_ideology
			traits = {  }
		}
		set_politics = {
			ruling_party = despotism
			elections_allowed = no
		}
		add_ideas = RUS_Nikolay_II_idea
		add_ideas = RUS_Alexeev_dictatorship_idea
	}
	option = {
		name = russian_ovrthrw_of_mon.11.c
		add_political_power = -50
		add_popularity = { ideology = authoritarism popularity = -0.05 }
	}
}

# Стратегия победы
country_event = {
	id = russian_ovrthrw_of_mon.12
	title = russian_ovrthrw_of_mon.12.t
	desc = russian_ovrthrw_of_mon.12.desc
	picture = GFX_report_event_narod_zemlya_svoboda_mir
	
	is_triggered_only = yes
	
	option = {
		name = russian_ovrthrw_of_mon.12.a
		hidden_effect = {
			set_country_flag = RUS_ovrtrw_mon_12_a
			country_event = { id = russian_ovrthrw_of_mon.13 days = 14 }
			country_event = { id = russian_ovrthrw_of_mon.14 days = 28 }
			country_event = { id = russian_ovrthrw_of_mon.15 days = 104 }
		}
	}
	option = {
		name = russian_ovrthrw_of_mon.12.b
		hidden_effect = {
			country_event = { id = russian_ovrthrw_of_mon.13 days = 14 }
			country_event = { id = russian_ovrthrw_of_mon.14 days = 28 }
			country_event = { id = russian_ovrthrw_of_mon.15 days = 52 }
		}
	}
	option = {
		name = russian_ovrthrw_of_mon.12.c
		hidden_effect = {
			country_event = { id = russian_ovrthrw_of_mon.13 days = 14 }
			country_event = { id = russian_ovrthrw_of_mon.14 days = 14 }
		}
		add_timed_idea = { idea = RUS_1917_tsarist_defense_focus days = 104 }
	}
}

country_event = {
	id = russian_ovrthrw_of_mon.13
	title = russian_ovrthrw_of_mon.13.t
	desc = russian_ovrthrw_of_mon.13.desc
	picture = GFX_report_event_narod_zemlya_svoboda_mir
	
	is_triggered_only = yes
	
	hidden = yes
	
	option = {
		name = russian_ovrthrw_of_mon.12.a
		if = {
			limit = { has_country_flag = RUS_ovrtrw_mon_12_a }
			add_ideas = RUS_collapse_of_railway_system_2
			else = {
				add_ideas = RUS_collapse_of_railway_system_1
			}
		}
	}
}
country_event = {
	id = russian_ovrthrw_of_mon.14
	title = russian_ovrthrw_of_mon.14.t
	desc = russian_ovrthrw_of_mon.14.desc
	picture = GFX_report_event_narod_zemlya_svoboda_mir
	
	is_triggered_only = yes
	
	hidden = yes
	
	option = {
		name = russian_ovrthrw_of_mon.14.a
		add_ideas = foodstuffs_supply_crisis_1
	}
}
country_event = {
	id = russian_ovrthrw_of_mon.15
	title = russian_ovrthrw_of_mon.15.t
	desc = russian_ovrthrw_of_mon.15.desc
	picture = GFX_report_event_narod_zemlya_svoboda_mir
	
	trigger = {
		has_country_flag = RUS_monarchy_not_fall
	}
	
	is_triggered_only = yes
	
	hidden = yes
	
	option = {
		name = russian_ovrthrw_of_mon.15.a
		if = {
			limit = { has_country_flag = RUS_ovrtrw_mon_12_a }
			add_timed_idea = { idea = RUS_1917_spring_offensive days = 104 }
			clr_country_flag = RUS_ovrtrw_mon_12_a
			else = {
				add_timed_idea = { idea = RUS_1917_spring_offensive days = 104 }
			}
		}
	}
}